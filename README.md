# Bilevel Optimization for Supply Chain Emission Reduction

## Manustript title: Technology selection for green transition using cap-and-trade in supply chains: a bilevel programming approach

## Submitted to: omega journal

## Authors: Massimiliano Caramia, Anna Laura Pala, Giuseppe Stecca 

This repository contains instances and computational results for a bilevel optimization model applied to supply chain emission reduction problems. The project includes three types of instances: **IR (Instances Random)**, **IB (Instances with limited Budget)**, and **real-world instances**.

## Instance Types

### 1. IR Instances (Initial Random)
**Creation Method**: Generated by `write_instances.py`

**Purpose**: The first set of instances developed for the computational analysis and referred as to **IR**, were generated by varying the following key parameters:

**Parameter Variations**:
- **Budget values (B)**: [3000, 5000, 7000, 10000]
- **Number of facilities (|F|)**: [3, 6, 9, 12]
- **Number of technology levels (|L|)**: [4, 8, 12]
- **Time horizon (|T|)**: [5, 10, 15]

**Additional Settings**:
- Number of suppliers equals the number of facilities in each instance.
- The maximum number of algorithm iterations is fixed at 100.
- For each supply chain configuration, five random instances are generated, resulting in a total of 720 instances.

### 2. IB Instances (Instances with limited Budget)
**Purpose**: A further set of instances has been developed in order to test the behaviour of the model, under strict budget constraints, by varying the other parameters related to network size, demand, emissions and cost factors.

**Characteristics**:
- The budget is set in such a way that facilities do not have enough budget to invest in the most effective (and most costly) emission abatement technology, forcing a non-homogeneous distribution of technology adoption among the network.
- The updated value $B'$ for each instance IB is computed, starting from the same valid IR instance, as:
  $$B' = |F| \times \bar{k} \times 1.5$$
  where $\bar{k}$ is the average value of investment technologies $k_{jl}, j \in F, l \in L$ in each instance.

### 3. Real-world Instances
**Description**: A case study modeling a cap-and-trade system for a **steel supply chain** distributed across Europe and Asia.

**Key Features**:
- **Technology Levels**: 4 distinct levels with specific emission/cost profiles:
    1. **Carbon-intensive BF (Blast Furnace)**: 1.8 tCO2/unit, 500 €/ton
    2. **Blue Hydrogen**: 1.0 tCO2/unit, 600 €/ton
    3. **Turquoise Hydrogen**: 0.6 tCO2/unit, 700 €/ton
    4. **Green Hydrogen**: 0.1 tCO2/unit, 850 €/ton
- **Parameters**: Calibrated on recent literature for the steel industry [1, 2, 3].
- **Horizon**: 10 years with linearly increasing demand (250 to 340 units/year).
- **Emissions Cap**: Starts at 65,000 tons and decreases over time.

## References

[1] Gu, Y., Pan, C., Sui, Y., Wang, B., Jiang, Z., Wang, C., & Liu, Y. (2023). CO2 emission accounting and emission reduction analysis of the steel production process based on the material-energy-carbon correlation effect. *Environmental Science and Pollution Research*, 30, 124010–124027.

[2] International Energy Agency. (2023). *Indicative production costs for crude steel via electrolytic hydrogen-based DRI in selected regions compared to current references*. IEA. [https://www.iea.org/data-and-statistics/charts/indicative-production-costs-for-crude-steel-via-electrolytic-hydrogen-based-dri-in-selected-regions-compared-to-current-references](https://www.iea.org/data-and-statistics/charts/indicative-production-costs-for-crude-steel-via-electrolytic-hydrogen-based-dri-in-selected-regions-compared-to-current-references). Accessed June 2025.

[3] Richardson, G., Appleby, P., De Campos, M., & Mostaghel, S. (2023). Green Hydrogen for Steel Production: A Case Study. In *Proceedings of the 61st Conference of Metallurgists, COM 2022* (pp. 193–201). Springer. DOI: [10.1007/978-3-031-17425-4_28](https://link.springer.com/chapter/10.1007/978-3-031-17425-4_28).


